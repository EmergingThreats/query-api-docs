
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">

    <!-- Always force latest IE rendering engine or request Chrome Frame -->
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

    <!-- Use title if it's in the page YAML frontmatter -->
    <title>API Reference</title>

    <link href="stylesheets/screen.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="stylesheets/print.css" media="print" rel="stylesheet" type="text/css" />
    <script src="//code.jquery.com/jquery-1.10.1.min.js"></script>
    <script src="javascripts/all.js" type="text/javascript"></script>

    <script>
      $(function() {
        var toc = $("#toc").tocify({
          selectors: "h1,h2",
          extendPage: false,
          theme: "none",
          smoothScroll: false,
          showEffectSpeed: 0,
          hideEffectSpeed: 180,
          ignoreSelector: ".toc-ignore",
          hashGenerator: 'pretty',
          highlightOffset: 60,
          scrollTo: -2,
          scrollHistory: true,
          hashGenerator: function(text, element) {
            return element[0].getAttribute('id');
          }
        }).data("toc-tocify");
        // Hack to make already open sections to start opened,
        // instead of displaying an ugly animation
        setTimeout(function() {
          toc.setOption("showEffectSpeed", 180);
        },50);
        setupLanguages([
          
            
              
                'curl',
              
            
          
        ]);
      });
    </script>
  </head>

  <body class="index">
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
      <div id="toc">
      </div>
      
      <ul class="toc-footer">
        
          <li><a href='http://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        
      </ul>
      
    </div>
    <div class="page-wrapper">
      <div class="content">
        <h1 id="introduction">Introduction</h1>

<blockquote>
<p>Summary of Resource URL Patterns</p>
</blockquote>
<pre class="highlight plaintext">/v1/domains/{domain}

/v1/domains/{domain}/urls

/v1/domains/{domain}/samples

/v1/domains/{domain}/ips

/v1/domains/{domain}/reputation

/v1/domains/{domain}/rephistory

/v1/domains/{domain}/nameservers

/v1/domains/{domain}/whois

/v1/ips/{ip}

/v1/ips/{ip}/urls

/v1/ips/{ip}/samples

/v1/ips/{ip}/domains

/v1/ips/{ip}/events

/v1/ips/{ip}/reputation

/v1/ips/{ip}/rephistory

/v1/samples/{md5}

/v1/samples/{md5}/connections

/v1/samples/{md5}/dns

/v1/samples/{md5}/http

/v1/samples/{md5}/events
</pre>

<p>The IQRisk Query API is organized around REST with JSON responses. Our API is designed to use HTTP response codes to indicate API success/errors. We support cross-origin resource sharing (CORS) to allow you to interact with our API from a client-side web application. JSON will be returned in all responses from the API.</p>

<p>The IQRisk Query API can be used to get information such as up-to-date reputation of domains and IPs, as well as related information on our entire database of over 100 million malware samples.</p>

<p>We currently have code examples using curl, and are working on other language examples. If you have a particular language you&rsquo;d like to see API examples for, please let us know. You can view code examples in the dark area to the right, and you can switch the programming language of the examples with the tabs in the top right.</p>

<h1 id="authentication">Authentication</h1>

<blockquote>
<p>To authenticate, use this code:</p>
</blockquote>
<pre class="highlight shell"><span class="c"># With curl, you can just pass the correct header with each request</span>
curl <span class="s2">"api_endpoint_here"</span>
  -H <span class="s2">"Authorization: SECRETKEY"</span>
</pre>

<blockquote>
<p>Make sure to replace <code class="prettyprint">SECRETKEY</code> with your API key.</p>
</blockquote>

<p>Emerging Threats uses API keys to allow access to our API. If your company has paid for API access, you can find your API key by visiting <a href="https://portal.emergingthreats.net/api-access">https://portal.emergingthreats.net/api-access</a>.</p>

<p>The Query API expects for the API key to be included in all API requests to the server in a header that looks like the following:</p>

<p><code class="prettyprint">Authorization: SECRETKEY</code></p>

<p><aside class="notice">
You must replace <code class="prettyprint">SECRETKEY</code> with your personal API key.
</aside></p>

<h1 id="domain-information">Domain Information</h1>

<h2 id="get-domain-info">Get domain info</h2>
<pre class="highlight shell">curl <span class="s2">"https://api.emergingthreats.net/v1/domains/{domain}"</span>
  -H <span class="s2">"Authorization: SECRETKEY"</span>
</pre>

<h2 id="get-domain-malware-requested-urls">Get domain malware-requested URLs</h2>
<pre class="highlight shell">curl <span class="s2">"https://api.emergingthreats.net/v1/domains/{domain}/urls"</span>
  -H <span class="s2">"Authorization: SECRETKEY"</span>
</pre>

<h2 id="get-domain-related-malware-samples">Get domain related malware samples</h2>
<pre class="highlight shell">curl <span class="s2">"https://api.emergingthreats.net/v1/domains/{domain}/samples"</span>
  -H <span class="s2">"Authorization: SECRETKEY"</span>
</pre>

<h2 id="get-domain-related-ips">Get domain related IPs</h2>
<pre class="highlight shell">curl <span class="s2">"https://api.emergingthreats.net/v1/domains/{domain}/ips"</span>
  -H <span class="s2">"Authorization: SECRETKEY"</span>
</pre>

<h2 id="get-domain-reputation">Get domain reputation</h2>
<pre class="highlight shell">curl <span class="s2">"https://api.emergingthreats.net/v1/domains/{domain}/reputation"</span>
  -H <span class="s2">"Authorization: SECRETKEY"</span>
</pre>

<h2 id="get-historical-domain-reputation">Get historical domain reputation</h2>
<pre class="highlight shell">curl <span class="s2">"https://api.emergingthreats.net/v1/domains/{domain}/rephistory"</span>
  -H <span class="s2">"Authorization: SECRETKEY"</span>
</pre>

<h2 id="get-domain-nameserver-info">Get domain nameserver info</h2>
<pre class="highlight shell">curl <span class="s2">"https://api.emergingthreats.net/v1/domains/{domain}/nameservers"</span>
  -H <span class="s2">"Authorization: SECRETKEY"</span>
</pre>

<h2 id="get-domain-whois-info">Get domain whois info</h2>
<pre class="highlight shell">curl <span class="s2">"https://api.emergingthreats.net/v1/domains/{domain}/whois"</span>
  -H <span class="s2">"Authorization: SECRETKEY"</span>
</pre>

<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"domain"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bing.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"registrant"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Microsoft Corporation"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"domains@microsoft.com"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"created"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1996-01-29"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"updated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-11-29"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expires"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-01-30"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"registrar"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MarkMonitor Inc."</span><span class="p">,</span><span class="w">
      </span><span class="s2">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USA"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"website"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://www.markmonitor.com"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>

<p>This endpoint retrieves whois info for a single domain.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://api.emergingthreats.net/v1/{domain}/whois</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>domain</td>
<td>None</td>
<td>The domain of the whois info to be retrieved.</td>
</tr>
</tbody></table>

<h3 id="response-parameters">Response Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>domain</td>
<td>No</td>
<td>The domain associated with the whois record.</td>
</tr>
<tr>
<td>registrant.name</td>
<td>Yes</td>
<td>Name of the domain registrant.</td>
</tr>
<tr>
<td>registrant.email</td>
<td>Yes</td>
<td>Email address of the domain registrant.</td>
</tr>
<tr>
<td>registrant.created</td>
<td>Yes</td>
<td>Date the whois record was originally created.</td>
</tr>
<tr>
<td>registrant.updated</td>
<td>Yes</td>
<td>Date the whois record was last updated.</td>
</tr>
<tr>
<td>registrant.expires</td>
<td>Yes</td>
<td>Date the whois record will expire.</td>
</tr>
<tr>
<td>registrar.name</td>
<td>Yes</td>
<td>Name of the domain registrar.</td>
</tr>
<tr>
<td>registrar.country</td>
<td>Yes</td>
<td>Home country of the domain registrar.</td>
</tr>
<tr>
<td>registrar.website</td>
<td>Yes</td>
<td>Homepage for the domain registrar.</td>
</tr>
</tbody></table>

<h1 id="ip-information">IP Information</h1>

<h2 id="get-ip-info">Get IP info</h2>
<pre class="highlight shell">curl <span class="s2">"https://api.emergingthreats.net/v1/ips/{ip}"</span>
  -H <span class="s2">"Authorization: SECRETKEY"</span>
</pre>

<h2 id="get-ip-malware-requested-urls">Get IP malware-requested URLs</h2>
<pre class="highlight shell">curl <span class="s2">"https://api.emergingthreats.net/v1/ips/{ip}/urls"</span>
  -H <span class="s2">"Authorization: SECRETKEY"</span>
</pre>

<h2 id="get-ip-related-malware-samples">Get IP related malware samples</h2>
<pre class="highlight shell">curl <span class="s2">"https://api.emergingthreats.net/v1/ips/{ip}/samples"</span>
  -H <span class="s2">"Authorization: SECRETKEY"</span>
</pre>

<h2 id="get-ip-related-domains">Get IP related domains</h2>
<pre class="highlight shell">curl <span class="s2">"https://api.emergingthreats.net/v1/ips/{ip}/domains"</span>
  -H <span class="s2">"Authorization: SECRETKEY"</span>
</pre>

<h2 id="get-ip-related-ids-events">Get IP related IDS events</h2>
<pre class="highlight shell">curl <span class="s2">"https://api.emergingthreats.net/v1/ips/{ip}/events"</span>
  -H <span class="s2">"Authorization: SECRETKEY"</span>
</pre>

<h2 id="get-ip-reputation">Get IP reputation</h2>
<pre class="highlight shell">curl <span class="s2">"https://api.emergingthreats.net/v1/ips/{ip}/reputation"</span>
  -H <span class="s2">"Authorization: SECRETKEY"</span>
</pre>

<h2 id="get-historical-ip-reputation">Get historical IP reputation</h2>
<pre class="highlight shell">curl <span class="s2">"https://api.emergingthreats.net/v1/ips/{ip}/rephistory"</span>
  -H <span class="s2">"Authorization: SECRETKEY"</span>
</pre>

<h1 id="malware-samples">Malware Samples</h1>

<h2 id="get-sample-details">Get sample details</h2>
<pre class="highlight shell">curl <span class="s2">"https://api.emergingthreats.net/v1/samples/{md5}"</span>
  -H <span class="s2">"Authorization: SECRETKEY"</span>
</pre>

<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"submit_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-06-11 04:00:00"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"file_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PE32 executable for MS Windows (DLL) (console) Intel 80386 32-bit"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"file_size"</span><span class="p">:</span><span class="w"> </span><span class="mi">69459</span><span class="p">,</span><span class="w">
    </span><span class="s2">"sha256"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e12012672d33cbcb22cf953ff787af250f8f5e920c565f03d4496a619c13a889"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ssdeep"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12288:ANkX6n+UtdHEhnLaoO2Ze9c+pq2NmUR0SEDRqHW2BUddM5d0HWO2QIbQ:8kX6n+uuNWoO2497p/NmURUyUddM5d0x"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>

<p>This endpoint retrieves metadata information for a single malware sample.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://api.emergingthreats.net/v1/samples/{md5}</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>md5</td>
<td>None</td>
<td>The md5sum of the malware sample to be retrieved.</td>
</tr>
</tbody></table>

<h3 id="response-parameters">Response Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>submit_date</td>
<td>No</td>
<td>The date and time the malware was originally submitted to Emerging Threats; format is yyyy-MM-dd HH:mm:ss</td>
</tr>
<tr>
<td>file_type</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>file_size</td>
<td>Yes</td>
<td>The size of the binary in bytes.</td>
</tr>
<tr>
<td>sha256</td>
<td>Yes</td>
<td>The SHA-256 hash of the binary.</td>
</tr>
<tr>
<td>ssdeep</td>
<td>Yes</td>
<td></td>
</tr>
</tbody></table>

<h2 id="get-sample-connections">Get sample connections</h2>
<pre class="highlight shell">curl <span class="s2">"https://api.emergingthreats.net/v1/samples/{md5}/connections"</span>
  -H <span class="s2">"Authorization: SECRETKEY"</span>
</pre>

<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"177f3c8a2623d4efb41b0020d680be83"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-03-31"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"source_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.10.104"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"destination_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"178.254.11.36"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"source_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">49382</span><span class="p">,</span><span class="w">
      </span><span class="s2">"destination_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bytes_down"</span><span class="p">:</span><span class="w"> </span><span class="mi">508</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bytes_up"</span><span class="p">:</span><span class="w"> </span><span class="mi">306</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bytes_total"</span><span class="p">:</span><span class="w"> </span><span class="mi">814</span><span class="p">,</span><span class="w">
      </span><span class="s2">"packets_down"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
      </span><span class="s2">"packets_up"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w">
      </span><span class="s2">"packets_total"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
      </span><span class="s2">"protocol"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tcp"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"177f3c8a2623d4efb41b0020d680be83"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-03-31"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"source_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.10.104"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"destination_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"208.117.232.117"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"source_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">49381</span><span class="p">,</span><span class="w">
      </span><span class="s2">"destination_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bytes_down"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bytes_up"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"bytes_total"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"packets_down"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="s2">"packets_up"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
      </span><span class="s2">"packets_total"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w">
      </span><span class="s2">"protocol"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tcp"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>

<p>This endpoint retrieves the most recent connections an individual malware sample was observed to have made.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://api.emergingthreats.net/v1/samples/{md5}/connections</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>md5</td>
<td>None</td>
<td>The md5sum of the malware sample whose connections are to be retrieved.</td>
</tr>
</tbody></table>

<h3 id="response-parameters">Response Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>source</td>
<td>No</td>
<td>The source of the connection.</td>
</tr>
<tr>
<td>date</td>
<td>No</td>
<td>The date the connection was observed.</td>
</tr>
<tr>
<td>source_ip</td>
<td>No</td>
<td>The source IP of the traffic associated with the connection.</td>
</tr>
<tr>
<td>destination_ip</td>
<td>No</td>
<td>The destination IP of the traffic associated with the connection.</td>
</tr>
<tr>
<td>source_port</td>
<td>No</td>
<td>The source port of the traffic associated with the connection.</td>
</tr>
<tr>
<td>destination_port</td>
<td>No</td>
<td>The destination port of the traffic associated with the connection.</td>
</tr>
<tr>
<td>bytes_down</td>
<td>Yes</td>
<td>The total number of bytes downloaded via this connection.</td>
</tr>
<tr>
<td>bytes_up</td>
<td>Yes</td>
<td>The total number of bytes uploaded via this connection.</td>
</tr>
<tr>
<td>bytes_total</td>
<td>Yes</td>
<td>The total number of bytes transmitted via this connection.</td>
</tr>
<tr>
<td>packets_down</td>
<td>Yes</td>
<td>The total number of packets downloaded via this connection.</td>
</tr>
<tr>
<td>packets_up</td>
<td>Yes</td>
<td>The total number of packets uploaded via this connection.</td>
</tr>
<tr>
<td>packets_total</td>
<td>Yes</td>
<td>The total number of packets transmitted via this connection.</td>
</tr>
<tr>
<td>protocol</td>
<td>Yes</td>
<td>The communication protocol associated with this connection (e.g. tcp, udp).</td>
</tr>
</tbody></table>

<h2 id="get-sample-dns-lookups">Get sample dns lookups</h2>
<pre class="highlight shell">curl <span class="s2">"https://api.emergingthreats.net/v1/samples/{md5}/dns"</span>
  -H <span class="s2">"Authorization: SECRETKEY"</span>
</pre>

<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"177f3c8a2623d4efb41b0020d680be83"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-04-02"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"domain"</span><span class="p">:</span><span class="w"> </span><span class="s2">"partirenimmobilier.fr"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"destination_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.10.1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"record_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"177f3c8a2623d4efb41b0020d680be83"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-04-02"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"domain"</span><span class="p">:</span><span class="w"> </span><span class="s2">"www.fredianipueyrredon.com.ar"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"destination_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.10.1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"record_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>

<p>This endpoint retrieves the most recent dns lookups an individual malware sample was observed to have made.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://api.emergingthreats.net/v1/samples/{md5}/dns</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>md5</td>
<td>None</td>
<td>The md5sum of the malware sample whose dns lookups are to be retrieved.</td>
</tr>
</tbody></table>

<h3 id="response-parameters">Response Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>source</td>
<td>No</td>
<td>The source of the dns lookup.</td>
</tr>
<tr>
<td>date</td>
<td>No</td>
<td>The date the lookup was observed.</td>
</tr>
<tr>
<td>domain</td>
<td>No</td>
<td>The domain whose DNS record was being queried.</td>
</tr>
<tr>
<td>answer</td>
<td>Yes</td>
<td>If the DNS response was not an A record pointing to an IP, this field will contain the DNS query response (e.g. the CNAME).</td>
</tr>
<tr>
<td>destination_ip</td>
<td>Yes</td>
<td>If the DNS response was an A record pointing to an IP, this field will contain the IP in question.</td>
</tr>
<tr>
<td>record_type</td>
<td>Yes</td>
<td>The DNS record type (e.g. A, CNAME, etc.)</td>
</tr>
</tbody></table>

<h2 id="get-sample-http-requests">Get sample http requests</h2>
<pre class="highlight shell">curl <span class="s2">"https://api.emergingthreats.net/v1/samples/{md5}/http"</span>
  -H <span class="s2">"Authorization: SECRETKEY"</span>
</pre>

<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"177f3c8a2623d4efb41b0020d680be83"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-04-02"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"domain"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vicaire.fr"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"source_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.10.102"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"destination_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.10.1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"source_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">49367</span><span class="p">,</span><span class="w">
      </span><span class="s2">"destination_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w">
      </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/images/1/filenames.php"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"user_agent"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"177f3c8a2623d4efb41b0020d680be83"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-04-02"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"domain"</span><span class="p">:</span><span class="w"> </span><span class="s2">"www.danielalmeida.adv.br"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"source_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.10.102"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"destination_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.10.1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"source_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">49351</span><span class="p">,</span><span class="w">
      </span><span class="s2">"destination_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w">
      </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/images/1/filenames.php"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"user_agent"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>

<p>This endpoint retrieves the most recent http requests an individual malware sample was observed to have made.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://api.emergingthreats.net/v1/samples/{md5}/http</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>md5</td>
<td>None</td>
<td>The md5sum of the malware sample whose http requests are to be retrieved.</td>
</tr>
</tbody></table>

<h3 id="response-parameters">Response Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>source</td>
<td>No</td>
<td>The source of the http request.</td>
</tr>
<tr>
<td>date</td>
<td>No</td>
<td>The date the request was observed.</td>
</tr>
<tr>
<td>domain</td>
<td>No</td>
<td>The domain the request was destined for.</td>
</tr>
<tr>
<td>source_ip</td>
<td>No</td>
<td>The source IP of the http request.</td>
</tr>
<tr>
<td>destination_ip</td>
<td>No</td>
<td>The IP the request was destined for.</td>
</tr>
<tr>
<td>source_port</td>
<td>No</td>
<td>The source port of the traffic associated with the request.</td>
</tr>
<tr>
<td>destination_port</td>
<td>No</td>
<td>The port the request was destined for.</td>
</tr>
<tr>
<td>method</td>
<td>Yes</td>
<td>The HTTP method used in the request.</td>
</tr>
<tr>
<td>url</td>
<td>Yes</td>
<td>The URL requested.</td>
</tr>
<tr>
<td>user_agent</td>
<td>Yes</td>
<td>The user agent string associated with the request.</td>
</tr>
</tbody></table>

<h2 id="get-sample-ids-events">Get sample IDS events</h2>
<pre class="highlight shell">curl <span class="s2">"https://api.emergingthreats.net/v1/samples/{md5}/events"</span>
  -H <span class="s2">"Authorization: SECRETKEY"</span>
</pre>

<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"177f3c8a2623d4efb41b0020d680be83"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-04-02"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sid"</span><span class="p">:</span><span class="w"> </span><span class="mi">2010228</span><span class="p">,</span><span class="w">
      </span><span class="s2">"source_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.10.102"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"destination_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.10.1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"source_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">49191</span><span class="p">,</span><span class="w">
      </span><span class="s2">"destination_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w">
      </span><span class="s2">"revision"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"signature_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ET POLICY Suspicious Microsoft Windows NT 6.1 User-Agent Detected"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"177f3c8a2623d4efb41b0020d680be83"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-03-31"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sid"</span><span class="p">:</span><span class="w"> </span><span class="mi">2001117</span><span class="p">,</span><span class="w">
      </span><span class="s2">"source_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.10.1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"destination_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.10.104"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"source_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">53</span><span class="p">,</span><span class="w">
      </span><span class="s2">"destination_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">51394</span><span class="p">,</span><span class="w">
      </span><span class="s2">"revision"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"signature_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ET DNS Standard query response, Name Error"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>

<p>This endpoint retrieves the most recent IDS events an individual malware sample was observed to have triggered.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://api.emergingthreats.net/v1/samples/{md5}/events</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>md5</td>
<td>None</td>
<td>The md5sum of the malware sample whose IDS events are to be retrieved.</td>
</tr>
</tbody></table>

<h3 id="response-parameters">Response Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>source</td>
<td>No</td>
<td>The source of the event.</td>
</tr>
<tr>
<td>date</td>
<td>No</td>
<td>The date the event was observed.</td>
</tr>
<tr>
<td>sid</td>
<td>No</td>
<td>The SID associated with the event.</td>
</tr>
<tr>
<td>source_ip</td>
<td>No</td>
<td>The source IP of the traffic associated with the event.</td>
</tr>
<tr>
<td>destination_ip</td>
<td>No</td>
<td>The destination IP of the traffic associated with the event.</td>
</tr>
<tr>
<td>source_port</td>
<td>No</td>
<td>The source port of the traffic associated with the event.</td>
</tr>
<tr>
<td>destination_port</td>
<td>No</td>
<td>The destination port of the traffic associated with the event.</td>
</tr>
<tr>
<td>revision</td>
<td>Yes</td>
<td>The rule revision of the SID in question.</td>
</tr>
<tr>
<td>signature_name</td>
<td>Yes</td>
<td>The name of the signature associated with this SID.</td>
</tr>
</tbody></table>

        
          
            <h1 id="errors">Errors</h1>

<p>The IQRisk Query API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>401</td>
<td>Unauthorized &ndash; Your API key is wrong</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden &ndash; The API key does not have access to the requested action</td>
</tr>
<tr>
<td>404</td>
<td>Not Found &ndash; The requested action does not exist</td>
</tr>
<tr>
<td>408</td>
<td>Request Timeout &ndash; The request took too long to complete on our side. Please reduce the amount of information you are requesting, or try again later.</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error &ndash; We had a problem internal to our systems. Please try again later.</td>
</tr>
</tbody></table>

          
        
      </div>
      <div class="dark-box">
        <div id="lang-selector">
          
            
              
                <a href="#" data-language-name="curl">curl</a>
              
            
          
        </div>
      </div>
    </div>
  </body>
</html>