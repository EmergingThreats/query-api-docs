
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>ET Intelligence API Reference</title>

    <style media="screen">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <style media="print">
      * {
        -webkit-transition:none!important;
        transition:none!important;
      }
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sa, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
    </style>
    <link href="stylesheets/screen-3d52762d.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-eefc9afe.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-e9bde216.js"></script>

    <script>
      $(function() { setupCodeCopy(); });
    </script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;python&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar-cad8cdcb.png" alt="" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo-47c8f189.png" class="logo" alt="" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
              <a href="#" data-language-name="python">Python (3.x)</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#authentication" class="toc-h1 toc-link" data-title="Authentication">Authentication</a>
          </li>
          <li>
            <a href="#rate-limiting" class="toc-h1 toc-link" data-title="Rate-limiting">Rate-limiting</a>
          </li>
          <li>
            <a href="#reputation-metadata" class="toc-h1 toc-link" data-title="Reputation Metadata">Reputation Metadata</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#list-reputation-categories" class="toc-h2 toc-link" data-title="List reputation categories">List reputation categories</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#cve-information-beta" class="toc-h1 toc-link" data-title="CVE Information BETA">CVE Information <sup>BETA</sup></a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#get-cve-details" class="toc-h2 toc-link" data-title="Get CVE Details">Get CVE Details</a>
                  </li>
                  <li>
                    <a href="#get-top-trending-cves" class="toc-h2 toc-link" data-title="Get Top trending CVEs">Get Top trending CVEs</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#domain-information" class="toc-h1 toc-link" data-title="Domain Information">Domain Information</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#get-current-domain-reputation" class="toc-h2 toc-link" data-title="Get current domain reputation">Get current domain reputation</a>
                  </li>
                  <li>
                    <a href="#get-domain-malware-requested-urls" class="toc-h2 toc-link" data-title="Get domain malware-requested URLs">Get domain malware-requested URLs</a>
                  </li>
                  <li>
                    <a href="#get-domain-related-malware-samples" class="toc-h2 toc-link" data-title="Get domain related malware samples">Get domain related malware samples</a>
                  </li>
                  <li>
                    <a href="#get-domain-related-ips" class="toc-h2 toc-link" data-title="Get domain related IPs">Get domain related IPs</a>
                  </li>
                  <li>
                    <a href="#get-domain-related-ids-events" class="toc-h2 toc-link" data-title="Get domain related IDS events">Get domain related IDS events</a>
                  </li>
                  <li>
                    <a href="#get-domain-nameserver-info" class="toc-h2 toc-link" data-title="Get domain nameserver info">Get domain nameserver info</a>
                  </li>
                  <li>
                    <a href="#get-domain-whois-info" class="toc-h2 toc-link" data-title="Get domain whois info">Get domain whois info</a>
                  </li>
                  <li>
                    <a href="#get-domain-geolocation-info" class="toc-h2 toc-link" data-title="Get domain geolocation info">Get domain geolocation info</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#ip-information" class="toc-h1 toc-link" data-title="IP Information">IP Information</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#get-current-ip-reputation" class="toc-h2 toc-link" data-title="Get current IP reputation">Get current IP reputation</a>
                  </li>
                  <li>
                    <a href="#get-ip-malware-requested-urls" class="toc-h2 toc-link" data-title="Get IP malware-requested URLs">Get IP malware-requested URLs</a>
                  </li>
                  <li>
                    <a href="#get-ip-related-malware-samples" class="toc-h2 toc-link" data-title="Get IP related malware samples">Get IP related malware samples</a>
                  </li>
                  <li>
                    <a href="#get-ip-related-domains" class="toc-h2 toc-link" data-title="Get IP related domains">Get IP related domains</a>
                  </li>
                  <li>
                    <a href="#get-ip-related-ids-events" class="toc-h2 toc-link" data-title="Get IP related IDS events">Get IP related IDS events</a>
                  </li>
                  <li>
                    <a href="#get-ip-geolocation-info" class="toc-h2 toc-link" data-title="Get IP geolocation info">Get IP geolocation info</a>
                  </li>
                  <li>
                    <a href="#get-ip-asn-info-new" class="toc-h2 toc-link" data-title="Get IP ASN Info New">Get IP ASN Info <sup>New</sup></a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#malware-informationbeta" class="toc-h1 toc-link" data-title="Malware InformationBETA">Malware Information<sup>BETA</sup></a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#get-malware-family-information" class="toc-h2 toc-link" data-title="Get Malware Family Information">Get Malware Family Information</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#malware-samples" class="toc-h1 toc-link" data-title="Malware Samples">Malware Samples</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#get-sample-details" class="toc-h2 toc-link" data-title="Get sample details">Get sample details</a>
                  </li>
                  <li>
                    <a href="#get-sample-connections" class="toc-h2 toc-link" data-title="Get sample connections">Get sample connections</a>
                  </li>
                  <li>
                    <a href="#get-sample-dns-lookups" class="toc-h2 toc-link" data-title="Get sample dns lookups">Get sample dns lookups</a>
                  </li>
                  <li>
                    <a href="#get-sample-http-requests" class="toc-h2 toc-link" data-title="Get sample http requests">Get sample http requests</a>
                  </li>
                  <li>
                    <a href="#get-sample-ids-events" class="toc-h2 toc-link" data-title="Get sample IDS events">Get sample IDS events</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#signature-information" class="toc-h1 toc-link" data-title="Signature Information">Signature Information</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#get-signature-name" class="toc-h2 toc-link" data-title="Get Signature name">Get Signature name</a>
                  </li>
                  <li>
                    <a href="#get-related-ip-addresses" class="toc-h2 toc-link" data-title="Get related IP addresses">Get related IP addresses</a>
                  </li>
                  <li>
                    <a href="#get-domain-sid" class="toc-h2 toc-link" data-title="Get domain SID">Get domain SID</a>
                  </li>
                  <li>
                    <a href="#get-sid-related-malware-samples" class="toc-h2 toc-link" data-title="Get sid related malware samples">Get sid related malware samples</a>
                  </li>
                  <li>
                    <a href="#get-signature-text" class="toc-h2 toc-link" data-title="Get Signature Text">Get Signature Text</a>
                  </li>
                  <li>
                    <a href="#get-signature-documentation" class="toc-h2 toc-link" data-title="Get Signature documentation">Get Signature documentation</a>
                  </li>
                  <li>
                    <a href="#get-signature-references" class="toc-h2 toc-link" data-title="Get Signature references">Get Signature references</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#threat-actor-informationbeta" class="toc-h1 toc-link" data-title="Threat Actor InformationBETA">Threat Actor Information<sup>BETA</sup></a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#get-threat-actor-bio-information" class="toc-h2 toc-link" data-title="Get Threat Actor Bio Information">Get Threat Actor Bio Information</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#trends-informationbeta" class="toc-h1 toc-link" data-title="Trends InformationBETA">Trends Information<sup>BETA</sup></a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#get-trends-information" class="toc-h2 toc-link" data-title="Get Trends Information">Get Trends Information</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="Errors">Errors</a>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://github.com/slatedocs/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<blockquote>
<p>Summary of Resource URL Patterns</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext tab-plaintext"><code>/v1/repcategories

/v1/cve/{cve}
/v1/cve/top-trending

/v1/domains/{domain}/events
/v1/domains/{domain}/geoloc
/v1/domains/{domain}/ips
/v1/domains/{domain}/nameservers
/v1/domains/{domain}/reputation
/v1/domains/{domain}/samples
/v1/domains/{domain}/urls
/v1/domains/{domain}/whois

/v1/ips/{ip}/domains
/v1/ips/{ip}/events
/v1/ips/{ip}/geoloc
/v1/ips/{ip}/reputation
/v1/ips/{ip}/samples
/v1/ips/{ip}/urls

/v1/malare/{malware_family}
/v1/samples/{md5}
/v1/samples/{md5}/connections
/v1/samples/{md5}/dns
/v1/samples/{md5}/events
/v1/samples/{md5}/http

/v1/sids/{sid}
/v1/sids/{sid}/ips
/v1/sids/{sid}/domains
/v1/sids/{sid}/samples

/v1/actors/{threatactor}
</code></pre></div>
<p>The ET Intelligence API is organized around REST with JSON responses. Our API is designed to use HTTP response codes to indicate API success/errors. We support cross-origin resource sharing (CORS) to allow you to interact with our API from a client-side web application. JSON will be returned in all responses from the API.</p>

<p>The ET Intelligence API can be used to get information such as up-to-date reputation of domains and IPs, as well as related information on our entire database of over 300 million malware samples.</p>

<p>We currently have code examples using curl and Python. If you have a particular language you&#39;d like to see API examples for, please let us know. You can view code examples in the dark area to the right, and you can switch the programming language of the examples with the tabs in the top right.</p>
<h1 id='authentication'>Authentication</h1>
<blockquote>
<p>To authenticate, use this code:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="c"># With curl, you can just pass the correct header with each request</span>
curl https://api.emergingthreats.net/v1/repcategories <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"api_endpoint_here"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Make sure to replace <code>SECRETKEY</code> with your API key.</p>
</blockquote>

<p>Emerging Threats uses API keys to allow access to our API. If your company has paid for API access, you can find your API key by visiting <a href="https://etadmin.proofpoint.com/api-access">https://etadmin.proofpoint.com/api-access</a>.</p>

<p>The Query API expects for the API key to be included in all API requests to the server in a header that looks like the following:</p>

<p><code>Authorization: SECRETKEY</code></p>

<aside class="notice">
You must replace `SECRETKEY` with your personal API key.
</aside>
<h1 id='rate-limiting'>Rate-limiting</h1>
<p>The ET Intelligence API will rate limit requests on a per-API key basis. If you exceed your rate limit you will receive an API response with a 429 HTTP status code and a brief message indicating you have exceeded your rate limit.
To increase your rate limit, contact sales.</p>

<blockquote>
<p>The JSON response associated with an exceeded rate limit should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Rate limit exceeded"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h1 id='reputation-metadata'>Reputation Metadata</h1><h2 id='list-reputation-categories'>List reputation categories</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl https://api.emergingthreats.net/v1/repcategories <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/repcategories"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bot"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Known Infected Bot"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CnC"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Malware Command and Control Server"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Spam"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Known Spam Source"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint lists all of the possible categories for reputation categorization and a brief description of each item.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/repcategories</code></p>
<h3 id='response-parameters'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>No</td>
<td>The name of the reputation category.</td>
</tr>
<tr>
<td>description</td>
<td>No</td>
<td>A brief description of the category.</td>
</tr>
</tbody></table>
<h1 id='cve-information-beta'>CVE Information <sup>BETA</sup></h1><h2 id='get-cve-details'>Get CVE Details</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/cve/{CVE}"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/cve/{CVE}"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>

</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2023-08-28-15:32:16"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"message_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"req877619770"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"cve"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CVE-2022-30525"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A OS command injection vulnerability in the CGI program of Zyxel USG FLEX 100(W) firmware versions 5.00 through 5.21 Patch 1, USG FLEX 200 firmware versions 5.00 through 5.21 Patch 1, USG FLEX 500 firmware versions 5.00 through 5.21 Patch 1, USG FLEX 700 firmware versions 5.00 through 5.21 Patch 1, USG FLEX 50(W) firmware versions 5.10 through 5.21 Patch 1, USG20(W)-VPN firmware versions 5.10 through 5.21 Patch 1, ATP series firmware versions 5.10 through 5.21 Patch 1, VPN series firmware versions 4.60 through 5.21 Patch 1, which could allow an attacker to modify specific files and then execute some OS commands on a vulnerable device."</span><span class="p">,</span><span class="w">
        </span><span class="nl">"config_operator"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OR"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"source_identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"security@zyxel.com.tw"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"vuln_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Analyzed"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"cisa_exploit_add"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-05-16"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"cisa_vulnerability_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Zyxel Multiple Firewalls OS Command Injection Vulnerability"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"known_exploited_vulnerabilities"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nl">"pfpt_recent_observed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nl">"pfpt_ever_observed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nl">"pfpt_first_observed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2023-03-01"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"pfpt_last_observed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2023-08-28"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"seven_day_trend"</span><span class="p">:</span><span class="w"> </span><span class="s2">"increasing"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"basemetricv3"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Primary"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nvd@nist.gov"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"cvssData"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"scope"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UNCHANGED"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.1"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"baseScore"</span><span class="p">:</span><span class="w"> </span><span class="mf">9.8</span><span class="p">,</span><span class="w">
                </span><span class="nl">"attackVector"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NETWORK"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"baseSeverity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CRITICAL"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"vectorString"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"integrityImpact"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HIGH"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"userInteraction"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NONE"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"attackComplexity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"LOW"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"availabilityImpact"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HIGH"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"privilegesRequired"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NONE"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"confidentialityImpact"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HIGH"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"impactScore"</span><span class="p">:</span><span class="w"> </span><span class="mf">5.9</span><span class="p">,</span><span class="w">
            </span><span class="nl">"exploitabilityScore"</span><span class="p">:</span><span class="w"> </span><span class="mf">3.9</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"basemetricv2"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Primary"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nvd@nist.gov"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"cvssData"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2.0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"baseScore"</span><span class="p">:</span><span class="w"> </span><span class="mf">10.0</span><span class="p">,</span><span class="w">
                </span><span class="nl">"accessVector"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NETWORK"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"vectorString"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AV:N/AC:L/Au:N/C:C/I:C/A:C"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"authentication"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NONE"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"integrityImpact"</span><span class="p">:</span><span class="w"> </span><span class="s2">"COMPLETE"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"accessComplexity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"LOW"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"availabilityImpact"</span><span class="p">:</span><span class="w"> </span><span class="s2">"COMPLETE"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"confidentialityImpact"</span><span class="p">:</span><span class="w"> </span><span class="s2">"COMPLETE"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"acInsufInfo"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nl">"impactScore"</span><span class="p">:</span><span class="w"> </span><span class="mf">10.0</span><span class="p">,</span><span class="w">
            </span><span class="nl">"baseSeverity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HIGH"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"obtainAllPrivilege"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nl">"exploitabilityScore"</span><span class="p">:</span><span class="w"> </span><span class="mf">10.0</span><span class="p">,</span><span class="w">
            </span><span class="nl">"obtainUserPrivilege"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nl">"obtainOtherPrivilege"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nl">"userInteractionRequired"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"weaknesses"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Primary"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nvd@nist.gov"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"lang"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CWE-78"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Secondary"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"security@zyxel.com.tw"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"lang"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CWE-78"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="nl">"publisheddate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-05-12"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"lastmodifieddate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-10-19"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves CVE information from NVD and Emerging Threats data. The endpoint relays whether there are known exploits, whether PFPT has observed exploit attempts, the first and last date of the observed exploit attempts and whether the exploit volume is increasing over the last week.  CVEs where we see active exploits should be considered high priority for patching if they are in your environment.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/cve/{cve}/</code></p>
<h3 id='response-parameters'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>cve</td>
<td>No</td>
<td>description</td>
</tr>
<tr>
<td>description</td>
<td>No</td>
<td>The description of CVE.</td>
</tr>
<tr>
<td>config_operator</td>
<td>No</td>
<td>It coveys the logical relationship of the CPE or child objects. It is part of configurations object containing the CVE applicability statements that convey which product, or products, are associated with the vulnerability according to the NVD analysis</td>
</tr>
<tr>
<td>source_identifier</td>
<td>No</td>
<td>It is an identifier for the source of the CVE.</td>
</tr>
<tr>
<td>vuln_status</td>
<td>No</td>
<td>The CVE status in the NVD portal.</td>
</tr>
<tr>
<td>cisa_exploit_add</td>
<td>No</td>
<td>The date when CVE is listed in CISA&#39;s Known Exploited Vulnerabilities (KEV) Catalog.</td>
</tr>
<tr>
<td>cisa_vulnerability_name</td>
<td>No</td>
<td>The name of the CVE vulnerability provided by CISA.</td>
</tr>
<tr>
<td>known_exploited_vulnerabilities</td>
<td>No</td>
<td>Boolean value determining if the CVE has known exploitable vulnerability.</td>
</tr>
<tr>
<td>pfpt_recent_observed</td>
<td>No</td>
<td>Boolean value determining if  CVE activity is captured by Proofpoint Systems recently.</td>
</tr>
<tr>
<td>pfpt_ever_observed</td>
<td>No</td>
<td>Boolean value determining if a CVE activity is captured by Proofpoint Systems.</td>
</tr>
<tr>
<td>pfpt_first_observed</td>
<td>No</td>
<td>Date when the CVE activity was first observed by Proofpoint Threat Intelligence Systems.</td>
</tr>
<tr>
<td>pfpt_last_observed</td>
<td>No</td>
<td>Date when the CVE activity was last observed by Proofpoint Threat Intelligence System.</td>
</tr>
<tr>
<td>seven_day_trend</td>
<td>No</td>
<td>Determines if the CVE activity trend is increasing,decreasing or nochange.</td>
</tr>
<tr>
<td>basemetricv3</td>
<td>Yes</td>
<td>Base metrics for CVSS version 3.1.</td>
</tr>
<tr>
<td>type</td>
<td>Yes</td>
<td>Identifies whether the organization is a primary or secondary source.</td>
</tr>
<tr>
<td>source</td>
<td>Yes</td>
<td>Identifies the organization that provided the metrics information.</td>
</tr>
<tr>
<td>scope</td>
<td>Yes</td>
<td>It is the ability for a vulnerability in one software component to impact resources beyond its means, or privileges.</td>
</tr>
<tr>
<td>version</td>
<td>Yes</td>
<td>Numeric representation of the current CVSS version.</td>
</tr>
<tr>
<td>baseScore</td>
<td>Yes</td>
<td>It reflects the severity of a vulnerability according to its intrinsic characteristics which are constant over time and assumes the reasonable worst case impact across different deployed environments.</td>
</tr>
<tr>
<td>attackVector</td>
<td>Yes</td>
<td>This metric reflects the context by which vulnerability exploitation is possible. This metric value (and consequently the Base score) will be larger the more remote (logically, and physically) an attacker can be in order to exploit the vulnerable component.</td>
</tr>
<tr>
<td>baseSeverity</td>
<td>Yes</td>
<td>It is the severity of a vulnerability.</td>
</tr>
<tr>
<td>vectorString</td>
<td>Yes</td>
<td>It is a text representation of a set of CVSS metrics.</td>
</tr>
<tr>
<td>integrityImpact</td>
<td>Yes</td>
<td>It measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and veracity of information.</td>
</tr>
<tr>
<td>userInteraction</td>
<td>Yes</td>
<td>It defines if the attacker relies on User Interaction by another person to perform actions required to exploit the vulnerability.</td>
</tr>
<tr>
<td>attackComplexity</td>
<td>Yes</td>
<td>It describes the conditions beyond the attackerâ€™s control that must exist in order to exploit the vulnerability.</td>
</tr>
<tr>
<td>availabilityImpact</td>
<td>Yes</td>
<td>It measures the impact to the availability of the impacted component resulting from a successfully exploited vulnerability.</td>
</tr>
<tr>
<td>confidentialityImpact</td>
<td>Yes</td>
<td>It measures the impact to the confidentiality of the information resources managed by a software component due to a successfully exploited vulnerability.</td>
</tr>
<tr>
<td>impactScore</td>
<td>Yes</td>
<td>It is the score of effects of a successfully exploited vulnerability on the component that suffers the worst outcome that is most directly and predictably associated with the attack.</td>
</tr>
<tr>
<td>exploitabilityScore</td>
<td>Yes</td>
<td>It is the score which reflects the ease and technical means by which the vulnerability can be exploited</td>
</tr>
<tr>
<td>basemetricv2</td>
<td>No</td>
<td>Base metrics for CVSS version 2.0</td>
</tr>
<tr>
<td>type</td>
<td>Yes</td>
<td>Identifies whether the organization is a primary or secondary source.</td>
</tr>
<tr>
<td>version</td>
<td>Yes</td>
<td>Numeric representation of the current CVSS version</td>
</tr>
<tr>
<td>baseScore</td>
<td>Yes</td>
<td>It reflects the severity of a vulnerability according to its intrinsic characteristics which are constant over time and assumes the reasonable worst case impact across different deployed environments.</td>
</tr>
<tr>
<td>accessVector</td>
<td>Yes</td>
<td>This metric reflects how the vulnerability is exploited.</td>
</tr>
<tr>
<td>vectorString</td>
<td>Yes</td>
<td>It is a text representation of a set of CVSS metrics.</td>
</tr>
<tr>
<td>authentication</td>
<td>Yes</td>
<td>measures the number of times an attacker must authenticate to a target in order to exploit a vulnerability. This metric does not gauge the strength or complexity of the authentication process, only that an attacker is required to provide credentials before an exploit may occur.</td>
</tr>
<tr>
<td>integrityImpact</td>
<td>Yes</td>
<td>It measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and guaranteed veracity of information.</td>
</tr>
<tr>
<td>accessComplexity</td>
<td>Yes</td>
<td>It measures whether or not extra conditions are required to exploit a vulnerability</td>
</tr>
<tr>
<td>availabilityImpact</td>
<td>Yes</td>
<td>It measures the impact to availability of a successfully exploited vulnerability. Availability refers to the accessibility of information resources.</td>
</tr>
<tr>
<td>confidentialityImpact</td>
<td>Yes</td>
<td>It  measures the impact on confidentiality of a successfully exploited vulnerability. Confidentiality refers to limiting information access and disclosure to only authorized users, as well as preventing access by, or disclosure to, unauthorized ones.</td>
</tr>
<tr>
<td>weaknesses</td>
<td>No</td>
<td>Information on specific weaknesses, considered the cause of the vulnerability.</td>
</tr>
<tr>
<td>publisheddate</td>
<td>No</td>
<td>The date and time that the CVE was published to the NVD.</td>
</tr>
<tr>
<td>lastmodifieddate</td>
<td>No</td>
<td>The date and time that the CVE was last modified,.</td>
</tr>
</tbody></table>
<h2 id='get-top-trending-cves'>Get Top trending CVEs</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/cve/top-trending"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/cve/top-trending?limit=5"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2023-08-29-20:31:23"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"message_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"req-2013631568"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"cve"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CVE-2022-22965"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"percent_change"</span><span class="p">:</span><span class="w"> </span><span class="mf">4891.857142857143</span><span class="p">,</span><span class="w">
            </span><span class="nl">"cvss_v3_score"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9.8"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A Spring MVC or Spring WebFlux application running on JDK 9+ may be vulnerable to remote code execution (RCE) via data binding. The specific exploit requires the application to run on Tomcat as a WAR deployment. If the application is deployed as a Spring Boot executable jar, i.e. the default, it is not vulnerable to the exploit. However, the nature of the vulnerability is more general, and there may be other ways to exploit it."</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"cve"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CVE-2021-44228"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"percent_change"</span><span class="p">:</span><span class="w"> </span><span class="mf">4751.073250490516</span><span class="p">,</span><span class="w">
            </span><span class="nl">"cvss_v3_score"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Apache Log4j2 2.0-beta9 through 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1) JNDI features used in configuration, log messages, and parameters do not protect against attacker controlled LDAP and other JNDI related endpoints. An attacker who can control log messages or log message parameters can execute arbitrary code loaded from LDAP servers when message lookup substitution is enabled. From log4j 2.15.0, this behavior has been disabled by default. From version 2.16.0 (along with 2.12.2, 2.12.3, and 2.3.1), this functionality has been completely removed. Note that this vulnerability is specific to log4j-core and does not affect log4net, log4cxx, or other Apache Logging Services projects."</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"cve"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CVE-2023-21690"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"percent_change"</span><span class="p">:</span><span class="w"> </span><span class="mf">2399.0</span><span class="p">,</span><span class="w">
            </span><span class="nl">"cvss_v3_score"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9.8"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Microsoft Protected Extensible Authentication Protocol (PEAP) Remote Code Execution Vulnerability"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"cve"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CVE-2020-25078"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"percent_change"</span><span class="p">:</span><span class="w"> </span><span class="mf">2251.9411764705883</span><span class="p">,</span><span class="w">
            </span><span class="nl">"cvss_v3_score"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7.5"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"An issue was discovered on D-Link DCS-2530L before 1.06.01 Hotfix and DCS-2670L through 2.02 devices. The unauthenticated /config/getuser endpoint allows for remote administrator password disclosure."</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"cve"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CVE-2017-17215"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"percent_change"</span><span class="p">:</span><span class="w"> </span><span class="mf">1999.0</span><span class="p">,</span><span class="w">
            </span><span class="nl">"cvss_v3_score"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8.8"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Huawei HG532 with some customized versions has a remote code execution vulnerability. An authenticated attacker could send malicious packets to port 37215 to launch attacks. Successful exploit could lead to the remote execution of arbitrary code."</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves the top 5 CVEs with highest exploit velocity over the last week.</p>
<h3 id='http-request-2'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/cve/top-trending?limit=5</code></p>
<h3 id='response-parameters-2'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>cve</td>
<td>No</td>
<td>The vulnerability identification number.</td>
</tr>
<tr>
<td>percent_change</td>
<td>No</td>
<td>The weekly percentage change by event volume.</td>
</tr>
<tr>
<td>cvss_v3_score</td>
<td>No</td>
<td>CVSS version 3.X base score for a vulnerability.</td>
</tr>
<tr>
<td>description</td>
<td>No</td>
<td>The description of vulnerability.</td>
</tr>
</tbody></table>

<p>This endpoint the highest volume exploit growth week over week targeting CVEs.  You can change the query from 5 to 10 if desired. </p>
<h1 id='domain-information'>Domain Information</h1><h2 id='get-current-domain-reputation'>Get current domain reputation</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/domains/{domain}/reputation"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/domains/{domain}/reputation"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"category"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DynDNS"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"score"</span><span class="p">:</span><span class="w"> </span><span class="mi">120</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"category"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CnC"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"score"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"category"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SpywareCnC"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"score"</span><span class="p">:</span><span class="w"> </span><span class="mi">95</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves the current reputation scores in categories that are currently associated with the specified domain.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/domains/{domain}/reputation</code></p>
<h3 id='response-parameters'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>category</td>
<td>No</td>
<td>The category of reputation under which this score falls.</td>
</tr>
<tr>
<td>score</td>
<td>No</td>
<td>The numerical reputation score for this category.  Scores are non-negative integers ranging from 0 to 127.</td>
</tr>
</tbody></table>
<h2 id='get-domain-malware-requested-urls'>Get domain malware-requested URLs</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/domains/{domain}/urls"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/domains/{domain}/urls"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"/index.php?id=XXXXXXXXXXXXXXX&amp;scn=X&amp;inf=X&amp;ver=XX&amp;cnt=XXX"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"/index.php?id=XXXXXXXXXXXXXX&amp;scn=X&amp;inf=X&amp;ver=XX&amp;cnt=XXX"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"/index.php?id=XXXXXXXXXXXXXXXXXX&amp;scn=X&amp;inf=X&amp;ver=XX&amp;cnt=XXX"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves the most recent http requests made by malware to the specified domain.</p>
<h3 id='http-request-2'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/domains/{domain}/urls</code></p>
<h3 id='response-parameters-2'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>No</td>
<td>The url string of the request with query parameter values masked.</td>
</tr>
</tbody></table>
<h2 id='get-domain-related-malware-samples'>Get domain related malware samples</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/domains/{domain}/samples"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/domains/{domain}/samples"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"45999bfea907bf37acbab63d5d9ea683"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"first_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-02-13"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"last_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-02-13"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f75da3cd3a38aadebdcf86eb53c6eb1c"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"first_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-02-13"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"last_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-02-13"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves the most recent malware samples that communicated with the specified domain.</p>
<h3 id='http-request-3'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/domains/{domain}/samples</code></p>
<h3 id='response-parameters-3'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>source</td>
<td>No</td>
<td>The md5sum of the malware sample.</td>
</tr>
<tr>
<td>first_seen</td>
<td>No</td>
<td>The date the malware sample was first seen associated to the domain.</td>
</tr>
<tr>
<td>last_seen</td>
<td>No</td>
<td>The date the malware sample was last seen associated to the domain.</td>
</tr>
</tbody></table>
<h2 id='get-domain-related-ips'>Get domain related IPs</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/domains/{domain}/ips"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/domains/{domain}/ips"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"213.219.245.212"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"first_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2011-12-04"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"last_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-02-27"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"78.109.30.160"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"first_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-02-22"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"last_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-04-09"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves the most recent IPs that have been associated with the specified domain.</p>
<h3 id='http-request-4'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/domains/{domain}/ips</code></p>
<h3 id='response-parameters-4'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ip</td>
<td>No</td>
<td></td>
</tr>
<tr>
<td>first_seen</td>
<td>No</td>
<td>The date the IP was first seen associated to the domain.</td>
</tr>
<tr>
<td>last_seen</td>
<td>No</td>
<td>The date the IP was last seen associated to the domain.</td>
</tr>
</tbody></table>
<h2 id='get-domain-related-ids-events'>Get domain related IDS events</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/domains/{domain}/events"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/domains/{domain}/events"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"domain"</span><span class="p">:</span><span class="w"> </span><span class="s2">"citi-bank.ru"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-03-31"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nl">"sid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2803583"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"signature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ETPRO TROJAN Win32.Sality.At Checkin"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"domain"</span><span class="p">:</span><span class="w"> </span><span class="s2">"citi-bank.ru"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-03-23"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nl">"sid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2803583"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"signature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ETPRO TROJAN Win32.Sality.At Checkin"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves the most recent IDS events that have been observed against the specified domain.</p>
<h3 id='http-request-5'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/domains/{domain}/events</code></p>
<h3 id='response-parameters-5'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>domain</td>
<td>No</td>
<td></td>
</tr>
<tr>
<td>date</td>
<td>No</td>
<td>The date the IDS event was observed.</td>
</tr>
<tr>
<td>source</td>
<td>No</td>
<td>Indicates whether the domain was the source of the IDS event.</td>
</tr>
<tr>
<td>sid</td>
<td>No</td>
<td>The SID that generated the IDS event.</td>
</tr>
<tr>
<td>signature</td>
<td>No</td>
<td>The signature name of the SID that generated the IDS event.</td>
</tr>
<tr>
<td>count</td>
<td>No</td>
<td>How many times this particular IDS event was observed in our sensor net for the given date.</td>
</tr>
</tbody></table>
<h2 id='get-domain-nameserver-info'>Get domain nameserver info</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/domains/{domain}/nameservers"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/domains/{domain}/nameservers"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"server"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ns1.yourhostingaccount.com."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"first_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-02-15"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"last_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-11-17"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"server"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ns1.mydomain.com"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"first_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-08-16"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"last_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-11-17"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves the nameserver information related to the specified domain.</p>
<h3 id='http-request-6'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/domains/{domain}/nameservers</code></p>
<h3 id='response-parameters-6'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>server</td>
<td>No</td>
<td>The address of a nameserver associated with the domain.</td>
</tr>
<tr>
<td>first_seen</td>
<td>Yes</td>
<td>The date the nameserver was first seen associated to the domain.</td>
</tr>
<tr>
<td>last_seen</td>
<td>Yes</td>
<td>The date the nameserver was last seen associated to the domain.</td>
</tr>
</tbody></table>
<h2 id='get-domain-whois-info'>Get domain whois info</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/domains/{domain}/whois"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/domains/{domain}/whois"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"domain"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bing.com"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"registrant"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Microsoft Corporation"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"domains@microsoft.com"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"created"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1996-01-29"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"updated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-11-29"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"expires"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-01-30"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"registrar"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MarkMonitor Inc."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"USA"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"website"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://www.markmonitor.com"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves whois info for a single domain.</p>
<h3 id='http-request-7'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/domains/{domain}/whois</code></p>
<h3 id='response-parameters-7'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>domain</td>
<td>No</td>
<td>The domain associated with the whois record.</td>
</tr>
<tr>
<td>registrant.name</td>
<td>Yes</td>
<td>Name of the domain registrant.</td>
</tr>
<tr>
<td>registrant.email</td>
<td>Yes</td>
<td>Email address of the domain registrant.</td>
</tr>
<tr>
<td>registrant.created</td>
<td>Yes</td>
<td>Date the whois record was originally created.</td>
</tr>
<tr>
<td>registrant.updated</td>
<td>Yes</td>
<td>Date the whois record was last updated.</td>
</tr>
<tr>
<td>registrant.expires</td>
<td>Yes</td>
<td>Date the whois record will expire.</td>
</tr>
<tr>
<td>registrar.name</td>
<td>Yes</td>
<td>Name of the domain registrar.</td>
</tr>
<tr>
<td>registrar.country</td>
<td>Yes</td>
<td>Home country of the domain registrar.</td>
</tr>
<tr>
<td>registrar.website</td>
<td>Yes</td>
<td>Homepage for the domain registrar.</td>
</tr>
</tbody></table>
<h2 id='get-domain-geolocation-info'>Get domain geolocation info</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/domains/{domain}/geoloc"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/domains/{domain}/geoloc"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"107.20.206.69"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"country_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"United States"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"region"</span><span class="p">:</span><span class="w"> </span><span class="s2">"VA"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Ashburn"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"latitude"</span><span class="p">:</span><span class="w"> </span><span class="mf">39.043701171875</span><span class="p">,</span><span class="w">
      </span><span class="nl">"longitude"</span><span class="p">:</span><span class="w"> </span><span class="mf">-77.48750305175781</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"216.38.198.78"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"country_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"United States"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"region"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CO"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Henderson"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"latitude"</span><span class="p">:</span><span class="w"> </span><span class="mf">39.88650131225586</span><span class="p">,</span><span class="w">
      </span><span class="nl">"longitude"</span><span class="p">:</span><span class="w"> </span><span class="mf">-104.88099670410156</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves geolocation info for a single domain.</p>
<h3 id='http-request-8'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/domains/{domain}/geoloc</code></p>
<h3 id='response-parameters-8'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ip</td>
<td>No</td>
<td>An IP associated with the specified domain.</td>
</tr>
<tr>
<td>country_code</td>
<td>No</td>
<td>The two character <a href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2">ISO 3166-1 alpha-2</a> country code in which the IP was last observed.</td>
</tr>
<tr>
<td>country</td>
<td>Yes</td>
<td>The country in which the IP was last observed.</td>
</tr>
<tr>
<td>region</td>
<td>Yes</td>
<td>A two character <a href="http://en.wikipedia.org/wiki/ISO_3166-2">ISO-3166-2</a> or <a href="http://en.wikipedia.org/wiki/FIPS_10-4">FIPS 10-4</a> code for the state or region associated with the IP.</td>
</tr>
<tr>
<td>city</td>
<td>Yes</td>
<td>The city or town name associated with the IP.</td>
</tr>
<tr>
<td>latitude</td>
<td>Yes</td>
<td>The latitude associated with the IP.</td>
</tr>
<tr>
<td>longitude</td>
<td>Yes</td>
<td>The longitude associated with the IP.</td>
</tr>
</tbody></table>
<h1 id='ip-information'>IP Information</h1><h2 id='get-current-ip-reputation'>Get current IP reputation</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/ips/{ip}/reputation"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/ips/{ip}/reputation"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"category"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DynDNS"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"score"</span><span class="p">:</span><span class="w"> </span><span class="mi">120</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"category"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CnC"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"score"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"category"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SpywareCnC"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"score"</span><span class="p">:</span><span class="w"> </span><span class="mi">95</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves the current reputation scores in categories that are currently associated with the specified IP.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/ips/{ip}/reputation</code></p>
<h3 id='response-parameters'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>category</td>
<td>No</td>
<td>The category of reputation under which this score falls.</td>
</tr>
<tr>
<td>score</td>
<td>No</td>
<td>The numerical reputation score for this category.  Scores are non-negative integers ranging from 0 to 127.</td>
</tr>
</tbody></table>
<h2 id='get-ip-malware-requested-urls'>Get IP malware-requested URLs</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/ips/{ip}/urls"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/ips/{ip}/urls"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"/index.php?id=XXXXXXXXXXXXXXX&amp;scn=X&amp;inf=X&amp;ver=XX&amp;cnt=XXX"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"/index.php?id=XXXXXXXXXXXXXX&amp;scn=X&amp;inf=X&amp;ver=XX&amp;cnt=XXX"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"/index.php?id=XXXXXXXXXXXXXXXXXX&amp;scn=X&amp;inf=X&amp;ver=XX&amp;cnt=XXX"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves the most recent http requests made by malware to the specified IP.</p>
<h3 id='http-request-2'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/ips/{ip}/urls</code></p>
<h3 id='response-parameters-2'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>No</td>
<td>The url string of the request with query parameter values masked.</td>
</tr>
</tbody></table>
<h2 id='get-ip-related-malware-samples'>Get IP related malware samples</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/ips/{ip}/samples"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/ips/{ip}/samples"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6c885bee0b4ef2f539b26298b252212d"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"first_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-05-13"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"last_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-05-13"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8449da068aec412fbec6fd48bc675396"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"first_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-05-03"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"last_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-05-03"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves the most recent malware samples that communicated with the specified IP.</p>
<h3 id='http-request-3'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/ips/{ip}/samples</code></p>
<h3 id='response-parameters-3'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>source</td>
<td>No</td>
<td>The md5sum of the malware sample.</td>
</tr>
<tr>
<td>first_seen</td>
<td>No</td>
<td>The date the malware sample was first seen associated to the IP.</td>
</tr>
<tr>
<td>last_seen</td>
<td>No</td>
<td>The date the malware sample was last seen associated to the IP.</td>
</tr>
</tbody></table>
<h2 id='get-ip-related-domains'>Get IP related domains</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/ips/{ip}/domains"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/ips/{ip}/domains"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"domain"</span><span class="p">:</span><span class="w"> </span><span class="s2">"citi-bank.ru"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"first_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-02-22"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"last_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-04-09"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"domain"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tat-neftbank.ru"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"first_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-04-04"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"last_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-04-04"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves the most recent domains that have been associated with the specified IP.</p>
<h3 id='http-request-4'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/ips/{ip}/domains</code></p>
<h3 id='response-parameters-4'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>domain</td>
<td>No</td>
<td></td>
</tr>
<tr>
<td>first_seen</td>
<td>No</td>
<td>The date the domain was first seen associated to the IP.</td>
</tr>
<tr>
<td>last_seen</td>
<td>No</td>
<td>The date the domain was last seen associated to the IP.</td>
</tr>
</tbody></table>
<h2 id='get-ip-related-ids-events'>Get IP related IDS events</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/ips/{ip}/events"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/ips/{ip}/events"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"208.111.161.254"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-04-08"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nl">"sid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2008365"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"signature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ET TROJAN Playtech Downloader Online Gaming Checkin"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"208.111.161.254"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-04-02"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nl">"sid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2008365"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"signature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ET TROJAN Playtech Downloader Online Gaming Checkin"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves the most recent IDS events that have been observed against the specified IP.</p>
<h3 id='http-request-5'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/ips/{ip}/events</code></p>
<h3 id='response-parameters-5'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ip</td>
<td>No</td>
<td>The string representation of the IP address, or &quot;private&quot; if it was a private IP.</td>
</tr>
<tr>
<td>date</td>
<td>No</td>
<td>The date the IDS event was observed.</td>
</tr>
<tr>
<td>source</td>
<td>No</td>
<td>Indicates whether the IP was the source of the IDS event.</td>
</tr>
<tr>
<td>sid</td>
<td>No</td>
<td>The SID that generated the IDS event.</td>
</tr>
<tr>
<td>signature</td>
<td>No</td>
<td>The signature name of the SID that generated the IDS event.</td>
</tr>
<tr>
<td>count</td>
<td>No</td>
<td>How many times this particular IDS event was observed in our sensor net for the given date.</td>
</tr>
</tbody></table>
<h2 id='get-ip-geolocation-info'>Get IP geolocation info</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/ips/{ip}/geoloc"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/ips/{ip}/geoloc"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"216.38.198.78"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"country_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"United States"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"region"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CO"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Henderson"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"latitude"</span><span class="p">:</span><span class="w"> </span><span class="mf">39.88650131225586</span><span class="p">,</span><span class="w">
      </span><span class="nl">"longitude"</span><span class="p">:</span><span class="w"> </span><span class="mf">-104.88099670410156</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves geolocation info for a single IP address.</p>
<h3 id='http-request-6'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/ips/{ip}/geoloc</code></p>
<h3 id='response-parameters-6'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ip</td>
<td>No</td>
<td>The IP address specified.</td>
</tr>
<tr>
<td>country_code</td>
<td>No</td>
<td>The two character <a href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2">ISO 3166-1 alpha-2</a> country code in which the IP was last observed.</td>
</tr>
<tr>
<td>country</td>
<td>Yes</td>
<td>The country in which the IP was last observed.</td>
</tr>
<tr>
<td>region</td>
<td>Yes</td>
<td>A two character <a href="http://en.wikipedia.org/wiki/ISO_3166-2">ISO-3166-2</a> or <a href="http://en.wikipedia.org/wiki/FIPS_10-4">FIPS 10-4</a> code for the state or region associated with the IP.</td>
</tr>
<tr>
<td>city</td>
<td>Yes</td>
<td>The city or town name associated with the IP.</td>
</tr>
<tr>
<td>latitude</td>
<td>Yes</td>
<td>The latitude associated with the IP.</td>
</tr>
<tr>
<td>longitude</td>
<td>Yes</td>
<td>The longitude associated with the IP.</td>
</tr>
</tbody></table>
<h2 id='get-ip-asn-info-new'>Get IP ASN Info <sup>New</sup></h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/ips/{ip}/asn"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/ips/{ip}/asn"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"asn"</span><span class="p">:</span><span class="w"> </span><span class="mi">15169</span><span class="p">,</span><span class="w">
        </span><span class="nl">"owner"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GOOGLE"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"authorizer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arin"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"registration_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2000-03-30"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"reverse_lookup"</span><span class="p">:</span><span class="w"> </span><span class="s2">"google-public-dns-a.google.com"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves asn info for a single IP address.</p>
<h3 id='http-request-7'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/ips/{ip}/asn</code></p>
<h3 id='response-parameters-7'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>asn</td>
<td>No</td>
<td>The 16 bit autonomous system number (ASN).</td>
</tr>
<tr>
<td>owner</td>
<td>No</td>
<td>The owner of the ASN.</td>
</tr>
<tr>
<td>authorizer</td>
<td>Yes</td>
<td>The authorizing body of ASN.</td>
</tr>
<tr>
<td>country</td>
<td>Yes</td>
<td>The country of origin.</td>
</tr>
<tr>
<td>registration_date</td>
<td>Yes</td>
<td>The date of ASN registration.</td>
</tr>
<tr>
<td>reverse_lookup</td>
<td>Yes</td>
<td>The reverse lookup address for an ASN.</td>
</tr>
</tbody></table>
<h1 id='malware-informationbeta'>Malware Information<sup>BETA</sup></h1><h2 id='get-malware-family-information'>Get Malware Family Information</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/malware/{malware_family}"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/malware/{malware_family}"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SocGholish"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"**SocGholish** is the name given to a malicious HTML injection written in JavaScript..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves the biographical information that PFPT has compiled on the malware families listed in the rule metadata.  Please follow the spelling and capitalization format found in the rule to ensure the response is valid.  E.G. SocGholish</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/malware/{malware_family}</code></p>
<h3 id='response-parameters'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>No</td>
<td>The name of Malware family.</td>
</tr>
<tr>
<td>description</td>
<td>No</td>
<td>The description of Malware Family.</td>
</tr>
</tbody></table>

<p>This will return information on malware families.  The only variable here is the malware family name which can be found on the ruleâ€™s metadata (e.g. Socghoulish)</p>
<h1 id='malware-samples'>Malware Samples</h1><h2 id='get-sample-details'>Get sample details</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/samples/{md5}"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/samples/{md5}"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"md5sum"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fa86e86e9dfb7a4571b3c3091fbf4bff"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"submit_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-06-11 04:00:00"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"file_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PE32 executable for MS Windows (DLL) (console) Intel 80386 32-bit"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"file_size"</span><span class="p">:</span><span class="w"> </span><span class="mi">69459</span><span class="p">,</span><span class="w">
    </span><span class="nl">"sha256"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e12012672d33cbcb22cf953ff787af250f8f5e920c565f03d4496a619c13a889"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves metadata information for a single malware sample.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/samples/{md5}</code></p>
<h3 id='response-parameters'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>md5</td>
<td>No</td>
<td>The MD5 hash of the binary.</td>
</tr>
<tr>
<td>submit_date</td>
<td>No</td>
<td>The date and time the malware was originally submitted to Emerging Threats; format is yyyy-MM-dd HH:mm:ss</td>
</tr>
<tr>
<td>file_type</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>file_size</td>
<td>Yes</td>
<td>The size of the binary in bytes.</td>
</tr>
<tr>
<td>sha256</td>
<td>Yes</td>
<td>The SHA-256 hash of the binary.</td>
</tr>
</tbody></table>
<h2 id='get-sample-connections'>Get sample connections</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/samples/{md5}/connections"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/samples/{md5}/connections"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"177f3c8a2623d4efb41b0020d680be83"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-03-31"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"source_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.10.104"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"destination_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"178.254.11.36"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"source_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">49382</span><span class="p">,</span><span class="w">
      </span><span class="nl">"destination_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w">
      </span><span class="nl">"bytes_down"</span><span class="p">:</span><span class="w"> </span><span class="mi">508</span><span class="p">,</span><span class="w">
      </span><span class="nl">"bytes_up"</span><span class="p">:</span><span class="w"> </span><span class="mi">306</span><span class="p">,</span><span class="w">
      </span><span class="nl">"bytes_total"</span><span class="p">:</span><span class="w"> </span><span class="mi">814</span><span class="p">,</span><span class="w">
      </span><span class="nl">"packets_down"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
      </span><span class="nl">"packets_up"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w">
      </span><span class="nl">"packets_total"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
      </span><span class="nl">"protocol"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tcp"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"177f3c8a2623d4efb41b0020d680be83"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-03-31"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"source_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.10.104"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"destination_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"208.117.232.117"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"source_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">49381</span><span class="p">,</span><span class="w">
      </span><span class="nl">"destination_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w">
      </span><span class="nl">"bytes_down"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nl">"bytes_up"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nl">"bytes_total"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nl">"packets_down"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="nl">"packets_up"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
      </span><span class="nl">"packets_total"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w">
      </span><span class="nl">"protocol"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tcp"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves the most recent connections an individual malware sample was observed to have made.</p>
<h3 id='http-request-2'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/samples/{md5}/connections</code></p>
<h3 id='response-parameters-2'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>source</td>
<td>No</td>
<td>The source of the connection.</td>
</tr>
<tr>
<td>date</td>
<td>No</td>
<td>The date the connection was observed.</td>
</tr>
<tr>
<td>source_ip</td>
<td>No</td>
<td>The source IP of the traffic associated with the connection.</td>
</tr>
<tr>
<td>destination_ip</td>
<td>No</td>
<td>The destination IP of the traffic associated with the connection.</td>
</tr>
<tr>
<td>source_port</td>
<td>No</td>
<td>The source port of the traffic associated with the connection.</td>
</tr>
<tr>
<td>destination_port</td>
<td>No</td>
<td>The destination port of the traffic associated with the connection.</td>
</tr>
<tr>
<td>bytes_down</td>
<td>Yes</td>
<td>The total number of bytes downloaded via this connection.</td>
</tr>
<tr>
<td>bytes_up</td>
<td>Yes</td>
<td>The total number of bytes uploaded via this connection.</td>
</tr>
<tr>
<td>bytes_total</td>
<td>Yes</td>
<td>The total number of bytes transmitted via this connection.</td>
</tr>
<tr>
<td>packets_down</td>
<td>Yes</td>
<td>The total number of packets downloaded via this connection.</td>
</tr>
<tr>
<td>packets_up</td>
<td>Yes</td>
<td>The total number of packets uploaded via this connection.</td>
</tr>
<tr>
<td>packets_total</td>
<td>Yes</td>
<td>The total number of packets transmitted via this connection.</td>
</tr>
<tr>
<td>protocol</td>
<td>Yes</td>
<td>The communication protocol associated with this connection (e.g. tcp, udp).</td>
</tr>
</tbody></table>
<h2 id='get-sample-dns-lookups'>Get sample dns lookups</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/samples/{md5}/dns"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/samples/{md5}/dns"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"177f3c8a2623d4efb41b0020d680be83"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-04-02"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"domain"</span><span class="p">:</span><span class="w"> </span><span class="s2">"partirenimmobilier.fr"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.10.1"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"record_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"177f3c8a2623d4efb41b0020d680be83"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-04-02"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"domain"</span><span class="p">:</span><span class="w"> </span><span class="s2">"www.fredianipueyrredon.com.ar"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.10.1"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"record_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves the most recent dns lookups an individual malware sample was observed to have made.</p>
<h3 id='http-request-3'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/samples/{md5}/dns</code></p>
<h3 id='response-parameters-3'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>source</td>
<td>No</td>
<td>The source of the dns lookup.</td>
</tr>
<tr>
<td>date</td>
<td>No</td>
<td>The date the lookup was observed.</td>
</tr>
<tr>
<td>domain</td>
<td>No</td>
<td>The domain whose DNS record was being queried.</td>
</tr>
<tr>
<td>answer</td>
<td>Yes</td>
<td>If the DNS response was not an A record pointing to an IP, this field will contain the DNS query response (e.g. the CNAME).</td>
</tr>
<tr>
<td>address</td>
<td>Yes</td>
<td>If the DNS response was an A record pointing to an IP, this field will contain the IP in question.</td>
</tr>
<tr>
<td>record_type</td>
<td>Yes</td>
<td>The DNS record type (e.g. A, CNAME, etc.)</td>
</tr>
</tbody></table>
<h2 id='get-sample-http-requests'>Get sample http requests</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/samples/{md5}/http"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/samples/{md5}/http"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"177f3c8a2623d4efb41b0020d680be83"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-04-02"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"domain"</span><span class="p">:</span><span class="w"> </span><span class="s2">"vicaire.fr"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"source_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.10.102"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"destination_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.10.1"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"source_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">49367</span><span class="p">,</span><span class="w">
      </span><span class="nl">"destination_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w">
      </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/images/1/filenames.php"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"user_agent"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"177f3c8a2623d4efb41b0020d680be83"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-04-02"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"domain"</span><span class="p">:</span><span class="w"> </span><span class="s2">"www.danielalmeida.adv.br"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"source_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.10.102"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"destination_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.10.1"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"source_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">49351</span><span class="p">,</span><span class="w">
      </span><span class="nl">"destination_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w">
      </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/images/1/filenames.php"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"user_agent"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves the most recent http requests an individual malware sample was observed to have made.</p>
<h3 id='http-request-4'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/samples/{md5}/http</code></p>
<h3 id='response-parameters-4'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>source</td>
<td>No</td>
<td>The source of the http request.</td>
</tr>
<tr>
<td>date</td>
<td>No</td>
<td>The date the request was observed.</td>
</tr>
<tr>
<td>domain</td>
<td>No</td>
<td>The domain the request was destined for.</td>
</tr>
<tr>
<td>source_ip</td>
<td>No</td>
<td>The source IP of the http request.</td>
</tr>
<tr>
<td>destination_ip</td>
<td>No</td>
<td>The IP the request was destined for.</td>
</tr>
<tr>
<td>source_port</td>
<td>Yes</td>
<td>The source port of the traffic associated with the request.</td>
</tr>
<tr>
<td>destination_port</td>
<td>Yes</td>
<td>The port the request was destined for.</td>
</tr>
<tr>
<td>method</td>
<td>Yes</td>
<td>The HTTP method used in the request.</td>
</tr>
<tr>
<td>url</td>
<td>Yes</td>
<td>The URL requested.</td>
</tr>
<tr>
<td>user_agent</td>
<td>Yes</td>
<td>The user agent string associated with the request.</td>
</tr>
</tbody></table>
<h2 id='get-sample-ids-events'>Get sample IDS events</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/samples/{md5}/events"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/samples/{md5}/events"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"177f3c8a2623d4efb41b0020d680be83"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-04-02"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"sid"</span><span class="p">:</span><span class="w"> </span><span class="mi">2010228</span><span class="p">,</span><span class="w">
      </span><span class="nl">"source_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.10.102"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"destination_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.10.1"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"source_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">49191</span><span class="p">,</span><span class="w">
      </span><span class="nl">"destination_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w">
      </span><span class="nl">"revision"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"signature_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ET POLICY Suspicious Microsoft Windows NT 6.1 User-Agent Detected"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"177f3c8a2623d4efb41b0020d680be83"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-03-31"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"sid"</span><span class="p">:</span><span class="w"> </span><span class="mi">2001117</span><span class="p">,</span><span class="w">
      </span><span class="nl">"source_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.10.1"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"destination_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.10.10.104"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"source_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">53</span><span class="p">,</span><span class="w">
      </span><span class="nl">"destination_port"</span><span class="p">:</span><span class="w"> </span><span class="mi">51394</span><span class="p">,</span><span class="w">
      </span><span class="nl">"revision"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"signature_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ET DNS Standard query response, Name Error"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves the most recent IDS events an individual malware sample was observed to have triggered.</p>
<h3 id='http-request-5'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/samples/{md5}/events</code></p>
<h3 id='response-parameters-5'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>source</td>
<td>No</td>
<td>The source of the event.</td>
</tr>
<tr>
<td>date</td>
<td>No</td>
<td>The date the event was observed.</td>
</tr>
<tr>
<td>sid</td>
<td>No</td>
<td>The SID associated with the event.</td>
</tr>
<tr>
<td>source_ip</td>
<td>No</td>
<td>The source IP of the traffic associated with the event.</td>
</tr>
<tr>
<td>destination_ip</td>
<td>No</td>
<td>The destination IP of the traffic associated with the event.</td>
</tr>
<tr>
<td>source_port</td>
<td>No</td>
<td>The source port of the traffic associated with the event.</td>
</tr>
<tr>
<td>destination_port</td>
<td>No</td>
<td>The destination port of the traffic associated with the event.</td>
</tr>
<tr>
<td>revision</td>
<td>Yes</td>
<td>The rule revision of the SID in question.</td>
</tr>
<tr>
<td>signature_name</td>
<td>Yes</td>
<td>The name of the signature associated with this SID.</td>
</tr>
</tbody></table>
<h1 id='signature-information'>Signature Information</h1><h2 id='get-signature-name'>Get Signature name</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/sids/{sid}"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/sids/{sid}"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"sid"</span><span class="p">:</span><span class="w"> </span><span class="mi">2007771</span><span class="p">,</span><span class="w">
    </span><span class="nl">"sig_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ET TROJAN Pushdo Update URL Detected"</span><span class="w">
  </span><span class="p">}</span><span class="w">

</span><span class="p">}</span><span class="w">
</span></code></pre></div><h3 id='http-request'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/sids/{sid}</code></p>
<h3 id='response-parameters'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>sid</td>
<td>no</td>
<td>Signature id that reflects request</td>
</tr>
<tr>
<td>sig_name</td>
<td>no</td>
<td>Name of the signature requested</td>
</tr>
</tbody></table>

<p>This endpoint retrieves the signature name for a particular Signature (SID).</p>
<h2 id='get-related-ip-addresses'>Get related IP addresses</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/sids/{sid}/ips"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/sids/{sid}/ips"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div><h3 id='request-parameters'>Request Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>sortBy</td>
<td>Yes</td>
<td>Valid values: &quot;ip&quot; and &quot;last_seen&quot;, controls the field results are ordered by. Default is &quot;last_seen&quot; if no value or invalid value provided</td>
</tr>
<tr>
<td>sortDirection</td>
<td>Yes</td>
<td>Valid values of &quot;ASC&quot; and &quot;DESC&quot;, descending is the default if no value provided, or invalid value</td>
</tr>
</tbody></table>

<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"long_ip"</span><span class="p">:</span><span class="w"> </span><span class="mi">16909060</span><span class="p">,</span><span class="w">
      </span><span class="nl">"ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.2.3.4"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"first_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-04-01"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"last_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-02-05"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"long_ip"</span><span class="p">:</span><span class="w"> </span><span class="mi">16909061</span><span class="p">,</span><span class="w">
      </span><span class="nl">"ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.2.3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"first_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-12-22"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"last_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-08-17"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h3 id='http-request-2'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/sids/{sid}/ips</code></p>
<h3 id='response-parameters-2'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>long_ip</td>
<td>no</td>
<td>Long number representation of an IP address</td>
</tr>
<tr>
<td>ip</td>
<td>no</td>
<td>Dotted notation representation of an IP address</td>
</tr>
<tr>
<td>first_seen</td>
<td>no</td>
<td>Date the IP was first observed for this SID</td>
</tr>
<tr>
<td>last_seen</td>
<td>no</td>
<td>Date the IP was last observed for this SID</td>
</tr>
</tbody></table>

<p>This endpoint retrieves the IPs related to a particular Signature (SID).</p>
<h2 id='get-domain-sid'>Get domain SID</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/sids/{sid}/domains"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/sids/{sid}/domains"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"domain"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wr.example.com"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"first_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-04-01"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"last_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-02-05"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"domain"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cc.example.com"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"first_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-12-22"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"last_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-08-17"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves the Domains related to a particular Signature (SID).</p>
<h3 id='http-request-3'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/sids/{sid}/domains</code></p>
<h3 id='response-parameters-3'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>domain</td>
<td>no</td>
<td>Domain name</td>
</tr>
<tr>
<td>first_seen</td>
<td>no</td>
<td>Date the IP was first observed for this SID</td>
</tr>
<tr>
<td>last_seen</td>
<td>no</td>
<td>Date the IP was last observed for this SID</td>
</tr>
</tbody></table>
<h2 id='get-sid-related-malware-samples'>Get sid related malware samples</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/sids/{sid}/samples"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/sids/{sid}/samples"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"45999bfea907bf37acbab63d5d9ea683"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"first_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-02-13"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"last_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-02-13"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f75da3cd3a38aadebdcf86eb53c6eb1c"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"first_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-02-13"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"last_seen"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-02-13"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves the most recent malware samples that communicated with the specified sid.</p>
<h3 id='http-request-4'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/sids/{sid}/samples</code></p>
<h3 id='response-parameters-4'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>source</td>
<td>No</td>
<td>The md5sum of the malware sample.</td>
</tr>
<tr>
<td>first_seen</td>
<td>No</td>
<td>The date the malware sample was first seen associated to the SID.</td>
</tr>
<tr>
<td>last_seen</td>
<td>No</td>
<td>The date the malware sample was last seen associated to the SID.</td>
</tr>
</tbody></table>
<h2 id='get-signature-text'>Get Signature Text</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/sids/{sid}/text"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/sids/{sid}/text"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"sid"</span><span class="p">:</span><span class="mi">2000005</span><span class="p">,</span><span class="w">
      </span><span class="nl">"suricata_text"</span><span class="p">:</span><span class="s2">"alert tcp $EXTERNAL_NET any -&gt; $HOME_NET 23 (msg:</span><span class="se">\"</span><span class="s2">ET EXPLOIT Cisco Telnet Buffer Overflow</span><span class="se">\"</span><span class="s2">; flow: to_server,established; content:</span><span class="se">\"</span><span class="s2">|3f 3f 3f 3f 3f 3f 3f 3f 3f 3f 3f 3f 3f 3f 3f 3f 3f 61 7e 20 25 25 25 25 25 58 58|</span><span class="se">\"</span><span class="s2">; threshold: type limit, track by_src, count 1, seconds 120; reference:url,www.cisco.com/warp/public/707/cisco-sn-20040326-exploits.shtml; reference:url,doc.emergingthreats.net/bin/view/Main/2000005; classtype:attempted-dos; sid:2000005; rev:7;)"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"snort_text"</span><span class="p">:</span><span class="s2">"alert tcp $EXTERNAL_NET any -&gt; $HOME_NET 23 (msg:</span><span class="se">\"</span><span class="s2">ET EXPLOIT Cisco Telnet Buffer Overflow</span><span class="se">\"</span><span class="s2">; flow: to_server,established; content:</span><span class="se">\"</span><span class="s2">|3f 3f 3f 3f 3f 3f 3f 3f 3f 3f 3f 3f 3f 3f 3f 3f 3f 61 7e 20 25 25 25 25 25 58 58|</span><span class="se">\"</span><span class="s2">; detection_filter: track by_src, count 1, seconds 120; reference:url,www.cisco.com/warp/public/707/cisco-sn-20040326-exploits.shtml; reference:url,doc.emergingthreats.net/bin/view/Main/2000005; classtype:attempted-dos; sid:2000005; rev:8;)"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves the most recent documentation available for the specified sid.  If you do not have access to the rule requested (i.e. the rule is for ETPro and you do not
have an ETPro subscription, this will return a 403 Forbidden.</p>
<h3 id='http-request-5'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/sids/{sid}/text</code></p>
<h3 id='response-parameters-5'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>sid</td>
<td>No</td>
<td>Sid that was requested</td>
</tr>
<tr>
<td>suricata_text</td>
<td>Yes</td>
<td>Example of the rule for Suricata</td>
</tr>
<tr>
<td>snort_text</td>
<td>Yes</td>
<td>Example of rule for Snort 2.9</td>
</tr>
</tbody></table>
<h2 id='get-signature-documentation'>Get Signature documentation</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/sids/{sid}/documentation"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/sids/{sid}/documentation"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"sid"</span><span class="p">:</span><span class="w"> </span><span class="mi">2000005</span><span class="p">,</span><span class="w">
      </span><span class="nl">"summary"</span><span class="p">:</span><span class="w"> </span><span class="s2">"This alert is triggered when an attempt is made to exploit a vulnerability in a system or application."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"An EXPLOIT Attempt event likely occurs when an attacker has attempted to gain
      unauthorized access to an asset or service by exploiting a direct vulnerability in an application or
      operating system. A successful exploitation of an asset or service may lead to malicious code being left
      behind to facilitate remote control. Further investigation may be needed to ascertain if an attacker successfully exploited this asset or service."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"impact"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Compromised Server"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves the most recent documentation available for the specified sid.</p>
<h3 id='http-request-6'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/sids/{sid}/documentation</code></p>
<h3 id='response-parameters-6'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>sid</td>
<td>No</td>
<td>Sid that was requested</td>
</tr>
<tr>
<td>summary</td>
<td>No</td>
<td>Summary of the information this alert is trying to convey.</td>
</tr>
<tr>
<td>description</td>
<td>No</td>
<td>Detailed description of the exploit being caught.</td>
</tr>
<tr>
<td>impact</td>
<td>No</td>
<td>What kinds of systems does this impact</td>
</tr>
</tbody></table>
<h2 id='get-signature-references'>Get Signature references</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/sids/{sid}/references"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/sids/{sid}/references"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"response"</span><span class="p">:</span><span class="w">
    </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"reference_type"</span><span class="p">:</span><span class="s2">"url"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"reference_description"</span><span class="p">:</span><span class="s2">"HTTP URL"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"reference_urls"</span><span class="p">:</span><span class="w">
          </span><span class="p">[</span><span class="w">
            </span><span class="s2">"http://doc.emergingthreats.net/bin/view/Main/2000005"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"http://www.cisco.com/warp/public/707/cisco-sn-20040326-exploits.shtml"</span><span class="w">
          </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves lookup references for this SID.</p>
<h3 id='http-request-7'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/sids/{sid}/references</code></p>
<h3 id='response-parameters-7'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>reference_type</td>
<td>No</td>
<td>The type of reference this refers to, as a key</td>
</tr>
<tr>
<td>reference_description</td>
<td>No</td>
<td>Plain text description of the reference type</td>
</tr>
<tr>
<td>reference_urls</td>
<td>No</td>
<td>List of urls to references</td>
</tr>
</tbody></table>
<h1 id='threat-actor-informationbeta'>Threat Actor Information<sup>BETA</sup></h1><h2 id='get-threat-actor-bio-information'>Get Threat Actor Bio Information</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/actors/{threatactor}"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/actors/{threatactor}"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TA453"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"**Name**</span><span class="se">\n\n</span><span class="s2">TA453</span><span class="se">\n\n</span><span class="s2">**Other Names**</span><span class="se">\n</span><span class="s2"> </span><span class="se">\n</span><span class="s2">Current names: CharmingKitten, Phosphorus..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves the biographical information that PFPT has compiled on the threat actor listed in the rule metadata. Please follow the spelling and capitalization format found in the rule to ensure the response is valid. E.G. TA453</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/actors/{threatactor}</code></p>
<h3 id='response-parameters'>Response Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>No</td>
<td>The name of Threat actor.</td>
</tr>
<tr>
<td>description</td>
<td>No</td>
<td>The description of Threat Actor.</td>
</tr>
</tbody></table>

<p>This will return information on threat actors.  The only variable here is the TA name which can be found on the ruleâ€™s metadata (e.g. TA453)</p>
<h1 id='trends-informationbeta'>Trends Information<sup>BETA</sup></h1><h2 id='get-trends-information'>Get Trends Information</h2><div class="highlight"><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.emergingthreats.net/v1/actors/{tag-name}/{report-name}"</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: SECRETKEY"</span>
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">api_key</span> <span class="o">=</span> <span class="s">"SECRETKEY"</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.emergingthreats.net/v1/actors/{tag-name}/{report-name}"</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">f'</span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">'</span><span class="p">}</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div>
<blockquote>
<p>The JSON response for cve/rolling-count should look something like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2023-12-05-21:19:15"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"message_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"req212112229"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"tag"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CVE-2021-35394"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"today-rank"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"seven-day-rank"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"thirty-day-rank"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="nl">"ninety-day-rank"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"tag"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CVE-2017-9841"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"today-rank"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="nl">"seven-day-rank"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="nl">"thirty-day-rank"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
            </span><span class="nl">"ninety-day-rank"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>The JSON response for cve/summaries should look something like:
<code>json
{
    &quot;success&quot;: true,
    &quot;timestamp&quot;: &quot;2023-12-05-21:19:15&quot;,
    &quot;message_id&quot;: &quot;req212112229&quot;,
    &quot;response&quot;: [
          {
            &quot;tag&quot;: &quot;CVE-2021-44228&quot;,
            &quot;event-rank&quot;: 1
        }
      ]
}
</code>
The JSON response for cve/activities should look something like:
<code>json
{
    &quot;success&quot;: true,
    &quot;timestamp&quot;: &quot;2023-12-05-21:19:15&quot;,
    &quot;message_id&quot;: &quot;req212112229&quot;,
    &quot;response&quot;: [
        {
            &quot;tag&quot;: &quot;CVE-2023-27350&quot;,
            &quot;current-week-activity-rank&quot;: 1,
            &quot;previous-week-activity-rank&quot;: 2
        }
      ]
}
</code>
This endpoint will provide the ET Intel trends in malware activity, threat actor activity, and CVE exploit trends ranked by ET Pro signature fire volume.</p>
</blockquote>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET https://api.emergingthreats.net/v1/tags/{tag-name}/{report-name}</code></p>
<h3 id='request-parameters'>Request Parameters</h3>
<table><thead>
<tr>
<th>tag-name</th>
<th></th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>cve</td>
<td></td>
<td>The top ranked CVE exploit attempts observed today.</td>
</tr>
<tr>
<td>malware</td>
<td></td>
<td>The top ranked malware families observed today.</td>
</tr>
<tr>
<td>threat-actor</td>
<td></td>
<td>The top ranked threat actors observed today.</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Report-name</th>
<th></th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>rolling-count</td>
<td></td>
<td>Provides the ranking from today, last week, 30 days ago, and 90 days ago.</td>
</tr>
<tr>
<td>summaries</td>
<td></td>
<td>Provides todayâ€™s signature fire volume ranking for today.</td>
</tr>
<tr>
<td>activities</td>
<td></td>
<td>Provides the week over week ranking based on volume.</td>
</tr>
</tbody></table>
<h3 id='available-request-parameter-combinations'>Available Request parameter combinations</h3>
<table><thead>
<tr>
<th>combinations</th>
</tr>
</thead><tbody>
<tr>
<td>cve/rolling-count</td>
</tr>
<tr>
<td>cve/summaries</td>
</tr>
<tr>
<td>cve/activities</td>
</tr>
<tr>
<td>malware/rolling-count</td>
</tr>
<tr>
<td>malware/summaries</td>
</tr>
<tr>
<td>malware/activities</td>
</tr>
<tr>
<td>threat-actor/rolling-count</td>
</tr>
<tr>
<td>threat-actor/summaries</td>
</tr>
<tr>
<td>threat-actor/activities</td>
</tr>
</tbody></table>
<h3 id='response-parameters-for-cve-rolling-count-parameter-combination'>Response Parameters for cve/rolling-count parameter combination</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>tag</td>
<td>No</td>
<td>The name/id of CVE exploit.</td>
</tr>
<tr>
<td>today-rank</td>
<td>No</td>
<td>CVE exploit ranking from today.</td>
</tr>
<tr>
<td>seven-day-rank</td>
<td>No</td>
<td>7 day ranking for CVE exploit.</td>
</tr>
<tr>
<td>thirty-day-rank</td>
<td>No</td>
<td>30 day ranking for CVE exploit.</td>
</tr>
<tr>
<td>ninety-day-rank</td>
<td>No</td>
<td>90 day ranking for CVE exploit.</td>
</tr>
</tbody></table>
<h3 id='response-parameters-for-cve-summaries-parameter-combination'>Response Parameters for cve/summaries parameter combination</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>tag</td>
<td>No</td>
<td>The name/id of CVE exploits.</td>
</tr>
<tr>
<td>event-rank</td>
<td>No</td>
<td>Event ranking for CVE Exploits.</td>
</tr>
</tbody></table>
<h3 id='response-parameters-for-cve-activities-parameter-combination'>Response Parameters for cve/activities parameter combination</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Optional?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>tag</td>
<td>No</td>
<td>The name/id of CVE exploit.</td>
</tr>
<tr>
<td>current-week-activity-rank</td>
<td>No</td>
<td>Current week activity ranking for CVE exploit.</td>
</tr>
<tr>
<td>previous-week-activity-rank</td>
<td>No</td>
<td>Previous week activity ranking for CVE exploit.</td>
</tr>
</tbody></table>

<p>Similarily the response parameters are same for other tag-name/report-name combinations</p>
<h1 id='errors'>Errors</h1>
<p>The ET Intelligence API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>401</td>
<td>Unauthorized -- You did not provide an API key.</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden -- The API key does not have access to the requested action or your subscription has elapsed.</td>
</tr>
<tr>
<td>404</td>
<td>Not Found -- The requested action does not exist.</td>
</tr>
<tr>
<td>408</td>
<td>Request Timeout -- The request took too long to complete on our side. Please reduce the amount of information you are requesting, or try again later.</td>
</tr>
<tr>
<td>429</td>
<td>Rate Limit Exceeded -- You have exceeded your provisioned rate limit. If this becomes a regular occurrence, please contact sales to have your rate limit increased.</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error -- We had a problem internal to our systems. Please try again later.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="python">Python (3.x)</a>
          </div>
      </div>
    </div>
  </body>
</html>
